import{e,j as s,X as a,g as t,Q as r,B as n,T as i,az as l,V as o,ad as d,q as c,k as x,aa as h,ab as p,W as u,ac as m,a as j,C as g,F as b,al as f,I as y,Y as v,a3 as C,a0 as w,a5 as S,a6 as z,a7 as A,aA as I,aB as W,aC as B,aD as L,v as $,a8 as k,aE as q}from"./vendor.17cb6192.js";import{u as D,a as N}from"./index.5c90ee8a.js";import"./firebase.99e0e815.js";const P=e=>e?e.charAt(0).toUpperCase()+e.slice(1).replace(/_/g," "):"Not specified",R=({status:e})=>{switch(e){case"approved":return s.jsx(o,{icon:s.jsx(u,{}),label:"Approved",color:"success",variant:"outlined",size:"small"});case"declined":return s.jsx(o,{icon:s.jsx(m,{}),label:"Declined",color:"error",variant:"outlined",size:"small"});case"completed":return s.jsx(o,{icon:s.jsx(u,{}),label:"Completed",color:"success",variant:"outlined",size:"small"});default:return s.jsx(o,{icon:s.jsx(p,{}),label:"Pending",color:"warning",variant:"outlined",size:"small"})}};function F({exchange:p,isAdmin:u=!1}){const m=e();if(!p)return s.jsx(a,{elevation:1,sx:{borderRadius:2,border:"1px solid",borderColor:"divider",transition:"all 0.2s ease-in-out","&:hover":{borderColor:"primary.light",boxShadow:`0 4px 10px ${t(m.palette.primary.main,.15)}`},overflow:"hidden"},children:s.jsx(r,{sx:{p:2},children:s.jsx(CircularProgress,{})})});const{id:j,status:g,productName:b,brand:f,condition:y,description:v,createdAt:C,transitStatus:w,trackingNumber:S,creditAmount:z}=p,A=new Date(C).toLocaleDateString(),I=(e=>null==e?"Pending":`$${e.toFixed(2)}`)(z);return s.jsxs(a,{elevation:1,sx:{borderRadius:2,border:"1px solid",borderColor:"divider",transition:"all 0.2s ease-in-out","&:hover":{borderColor:"primary.light",boxShadow:`0 4px 10px ${t(m.palette.primary.main,.15)}`},overflow:"hidden"},children:["approved"===g&&z>0&&s.jsx(n,{sx:{bgcolor:t(m.palette.success.main,.1),py:.75,px:2,display:"flex",alignItems:"center",justifyContent:"flex-end",borderBottom:"1px solid",borderColor:t(m.palette.success.main,.2)},children:s.jsxs(i,{variant:"body2",sx:{color:"success.main",fontWeight:"medium",display:"flex",alignItems:"center"},children:[s.jsx(l,{fontSize:"small",sx:{mr:.5}}),"Credit Assigned: ",I]})}),s.jsxs(r,{sx:{p:2},children:[s.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1.5},children:[s.jsxs(n,{children:[s.jsx(i,{variant:"subtitle1",component:"div",sx:{fontWeight:600,mb:.5,display:"flex",alignItems:"flex-start",gap:1},children:b}),s.jsxs(i,{variant:"body2",color:"text.secondary",sx:{mb:1},children:[A," â€¢ ",f]})]}),s.jsx(R,{status:g})]}),s.jsxs(n,{sx:{display:"flex",flexWrap:"wrap",gap:1,mb:2},children:[s.jsx(o,{label:`Condition: ${P(y)}`,size:"small",variant:"outlined",color:"primary"}),w&&s.jsx(o,{icon:s.jsx(d,{fontSize:"small"}),label:`Transit: ${w.charAt(0).toUpperCase()+w.slice(1)}`,size:"small",color:"info",variant:"outlined"})]}),v&&s.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:2,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:v}),s.jsx(n,{sx:{display:"flex",justifyContent:"flex-end"},children:s.jsx(c,{component:x,to:u?`/admin/exchange/${j}`:`/exchange/${j}`,color:"primary",size:"small",endIcon:s.jsx(h,{}),children:"View Details"})})]})]})}function T(){const{currentUser:r}=D(),[l,o]=j.useState([]),[d,h]=j.useState(!0),[p,u]=j.useState(""),[m,P]=j.useState(""),[R,T]=j.useState("all"),[E,M]=j.useState(1),[U,O]=j.useState(!1),V=e();j.useEffect((()=>{Y()}),[r]);const Y=async()=>{try{h(!0),u(""),O(!0);const e=await r.getIdToken(),s=await N.get("/api/exchange",{headers:{Authorization:`Bearer ${e}`}});o(s.data)}catch(e){u("Failed to load your exchange requests. Please try again later.")}finally{h(!1),O(!1)}},Q=l.filter((e=>{var s,a,t;const r=(null==(s=e.productName)?void 0:s.toLowerCase().includes(m.toLowerCase()))||(null==(a=e.brand)?void 0:a.toLowerCase().includes(m.toLowerCase()))||(null==(t=e.description)?void 0:t.toLowerCase().includes(m.toLowerCase())),n="all"===R||e.status===R;return r&&n})),X=Q.slice(10*(E-1),10*E),_=Math.ceil(Q.length/10);return d&&!U?s.jsx(g,{maxWidth:"lg",sx:{py:4},children:s.jsx(n,{sx:{display:"flex",justifyContent:"center",my:8},children:s.jsx(b,{})})}):s.jsxs(g,{maxWidth:"lg",sx:{py:4},children:[s.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4,flexDirection:{xs:"column",sm:"row"},gap:{xs:2,sm:0}},children:[s.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[s.jsx(c,{component:x,to:"/dashboard",startIcon:s.jsx(f,{}),sx:{mr:2},children:"Back"}),s.jsx(i,{variant:"h4",component:"h1",sx:{fontWeight:"bold",color:V.palette.primary.main},children:"My Exchange Requests"})]}),s.jsx(y,{onClick:()=>{Y()},color:"primary",sx:{bgcolor:t(V.palette.primary.main,.1),"&:hover":{bgcolor:t(V.palette.primary.main,.2)}},children:s.jsx(v,{})})]}),p&&s.jsx(C,{severity:"error",sx:{mb:4},children:p}),s.jsx(a,{elevation:1,sx:{p:2,mb:4,borderRadius:2},children:s.jsxs(w,{container:!0,spacing:2,alignItems:"center",children:[s.jsx(w,{item:!0,xs:12,md:6,children:s.jsx(S,{fullWidth:!0,placeholder:"Search by product name, brand, or description",value:m,onChange:e=>{P(e.target.value),M(1)},variant:"outlined",size:"small",InputProps:{startAdornment:s.jsx(z,{position:"start",children:s.jsx(A,{fontSize:"small"})})}})}),s.jsx(w,{item:!0,xs:12,md:6,children:s.jsxs(I,{fullWidth:!0,variant:"outlined",size:"small",children:[s.jsx(W,{id:"status-filter-label",children:"Status"}),s.jsxs(B,{labelId:"status-filter-label",value:R,onChange:e=>{T(e.target.value),M(1)},label:"Status",startAdornment:s.jsx(z,{position:"start",children:s.jsx(L,{fontSize:"small"})}),children:[s.jsx($,{value:"all",children:"All Statuses"}),s.jsx($,{value:"pending",children:"Pending"}),s.jsx($,{value:"approved",children:"Approved"}),s.jsx($,{value:"declined",children:"Declined"}),s.jsx($,{value:"completed",children:"Completed"})]})]})})]})}),s.jsx(n,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:s.jsxs(i,{variant:"body2",color:"text.secondary",children:["Showing ",Q.length>0?10*(E-1)+1:0,"-",Math.min(10*E,Q.length)," of ",Q.length," requests"]})}),0===Q.length?s.jsxs(a,{sx:{p:4,textAlign:"center",borderRadius:2},children:[s.jsx(i,{variant:"h6",gutterBottom:!0,children:"No exchange requests found"}),s.jsx(i,{variant:"body1",color:"text.secondary",sx:{mb:3},children:m||"all"!==R?"Try changing your search criteria or filters":"You have not created any exchange requests yet"}),s.jsx(c,{variant:"contained",component:x,to:"/exchange/new",color:"primary",children:"Create New Exchange Request"})]}):s.jsxs(s.Fragment,{children:[s.jsx(k,{spacing:2,sx:{mb:4},children:X.map((e=>s.jsx(F,{exchange:e},e.id)))}),_>1&&s.jsx(n,{sx:{display:"flex",justifyContent:"center",mt:4},children:s.jsx(q,{count:_,page:E,onChange:(e,s)=>{M(s),window.scrollTo({top:0,behavior:"smooth"})},color:"primary",shape:"rounded",showFirstButton:!0,showLastButton:!0})})]})]})}export{T as default};
