import{e,g as a,j as o,P as r,Q as t,B as s,x as n,T as i,U as l,V as c,W as d,C as x,X as h,q as u,Y as p,Z as f,_ as g,$ as m,a as b,f as j,a0 as y,a1 as v,k as w,I as S,a2 as C,a3 as k,a4 as A,S as I,a5 as z,a6 as R,a7 as W,a8 as $,a9 as P,aa as _,ab as E,ac as F,A as D,K as T,ad as L}from"./vendor.17cb6192.js";import{u as N,a as O}from"./index.5c90ee8a.js";import"./firebase.99e0e815.js";const U=({creditAmount:x=0,creditCurrency:h="INR",isLoading:u=!1,username:p=""})=>{e();const f={background:"linear-gradient(135deg, #1a1a1a 0%, #333 50%, #1a1a1a 100%)",color:"white",position:"relative",overflow:"hidden",aspectRatio:"1.586/1",maxHeight:"220px",display:"flex",flexDirection:"column",justifyContent:"space-between",borderRadius:"12px",boxShadow:`0 15px 25px ${a("#000",.25)}`,border:`1px solid ${a("#fff",.1)}`,backdropFilter:"blur(10px)"};return u?o.jsxs(r,{elevation:0,sx:f,children:[o.jsxs(t,{children:[o.jsxs(s,{sx:{display:"flex",alignItems:"center",mb:2},children:[o.jsx(n,{sx:{mr:1,fontSize:28}}),o.jsx(i,{variant:"h6",component:"div",sx:{fontWeight:600},children:"Available Loyalty Points"})]}),o.jsxs(s,{sx:{pt:1},children:[o.jsx(l,{variant:"text",width:"70%",height:60,sx:{bgcolor:a("#ffffff",.1)}}),o.jsx(l,{variant:"text",width:"90%",height:20,sx:{bgcolor:a("#ffffff",.1),mt:1}})]})]}),o.jsx(s,{sx:{p:2,bgcolor:a("#ffffff",.05)},children:o.jsx(l,{variant:"text",width:"50%",height:20,sx:{bgcolor:a("#ffffff",.1)}})})]}):o.jsxs(r,{elevation:0,sx:f,children:[o.jsx(s,{sx:{position:"absolute",top:0,right:0,width:"120%",height:"120%",background:`\n            radial-gradient(circle at 70% 30%, ${a("#fff",.15)} 0%, transparent 25%),\n            radial-gradient(circle at 20% 70%, ${a("#fff",.1)} 0%, transparent 20%)\n          `,opacity:.8,transform:"translateX(-10%) translateY(-10%)"}}),o.jsx(s,{sx:{position:"absolute",top:70,left:20,width:40,height:30,borderRadius:1,bgcolor:a("#c0c0c0",.5),backgroundImage:`linear-gradient(90deg, ${a("#fff",.3)} 0%, ${a("#888",.3)} 50%, ${a("#fff",.3)} 100%)`,boxShadow:`inset 0 0 2px ${a("#fff",.5)}`,zIndex:2}}),o.jsx(s,{sx:{position:"absolute",top:0,right:0,width:"100%",height:"100%",opacity:.05,backgroundImage:'url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"/></svg>\')',backgroundRepeat:"no-repeat",backgroundPosition:"right 20px",backgroundSize:"180px",transform:"rotate(-5deg)"}}),o.jsxs(t,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"space-between",p:2.5,zIndex:3,position:"relative"},children:[o.jsxs(s,{children:[o.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1},children:[o.jsx(i,{variant:"h6",component:"div",sx:{fontWeight:600,fontSize:"1rem",color:"#fff"},children:"Available Loyalty Points"}),o.jsx(n,{sx:{fontSize:24,color:"#fff"}})]}),o.jsx(c,{icon:o.jsx(d,{sx:{fontSize:"1rem !important"}}),label:"Points Active",size:"small",variant:"outlined",sx:{height:22,"& .MuiChip-label":{fontSize:"0.7rem",px:1,color:"#fff"},"& .MuiChip-icon":{color:"#c0c0c0"},bgcolor:a("#fff",.1),borderColor:a("#fff",.3),mb:1.5,backdropFilter:"blur(5px)"}}),o.jsxs(i,{variant:"h4",component:"div",sx:{fontWeight:"bold",mb:.5,fontSize:"1.7rem",color:"#fff",textShadow:`0 0 10px ${a("#fff",.3)}`},children:[(e=>{switch(e){case"INR":return"₹";case"USD":return"$";case"EUR":return"€";case"GBP":return"£";default:return e}})(h),x.toFixed(2)]}),o.jsx(i,{variant:"body2",sx:{color:a("#fff",.9),fontSize:"0.8rem"},children:"Ready to use on your next purchase"})]}),o.jsxs(s,{children:[o.jsx(i,{variant:"body2",sx:{color:a("#fff",.7),fontSize:"0.7rem",letterSpacing:1},children:"CARDHOLDER"}),o.jsx(i,{variant:"body1",sx:{color:a("#fff",.9),fontWeight:"medium",letterSpacing:.5,fontSize:"0.85rem"},children:(g=p,g?g.includes("@")?g.split("@")[0].toUpperCase():g.toUpperCase():"VALUED CUSTOMER")})]})]}),o.jsxs(s,{sx:{p:1.5,bgcolor:a("#000",.3),backdropFilter:"blur(5px)",display:"flex",justifyContent:"space-between",alignItems:"center",borderTop:`1px solid ${a("#fff",.1)}`},children:[o.jsx(i,{variant:"caption",sx:{fontWeight:"medium",letterSpacing:.5,color:a("#fff",.8)},children:"SWAP • POINTS • SHOP"}),o.jsx(i,{variant:"caption",sx:{fontWeight:"medium",letterSpacing:.5,color:a("#fff",.8)},children:"VALID THRU: ∞"})]})]});var g},M=({errorType:r="shopify_user_not_found",message:t,onRetry:n,email:l})=>{e();const c=(()=>{switch(r){case"shopify_user_not_found":return{title:"Shopify Account Not Found",icon:o.jsx(m,{sx:{fontSize:60,color:"#1a1a1a",mb:2}}),description:l?`We couldn't find a Shopify account linked to ${l}. Please make sure you're using the same email address associated with your Shopify account.`:"We couldn't find your Shopify account. Please make sure you're using the same email address associated with your Shopify account.",primaryAction:"Try Again",secondaryAction:"Contact Support"};case"connection_error":return{title:"Connection Error",icon:o.jsx(g,{sx:{fontSize:60,color:"#555555",mb:2}}),description:"We're having trouble connecting to Shopify. This might be a temporary issue. Please try again in a few moments.",primaryAction:"Refresh",secondaryAction:"Contact Support"};case"auth_error":return{title:"Authentication Error",icon:o.jsx(g,{sx:{fontSize:60,color:"#666666",mb:2}}),description:"There was a problem with your authentication. Please try signing in again.",primaryAction:"Try Again",secondaryAction:"Sign Out"};default:return{title:"Something Went Wrong",icon:o.jsx(g,{sx:{fontSize:60,color:"#444444",mb:2}}),description:t||"An unexpected error occurred. Please try again later.",primaryAction:"Refresh",secondaryAction:"Contact Support"}}})();return o.jsx(x,{maxWidth:"sm",children:o.jsxs(h,{elevation:2,sx:{p:4,mt:4,textAlign:"center",borderRadius:2,border:`1px solid ${a("#1a1a1a",.2)}`,boxShadow:`0 4px 20px ${a("#1a1a1a",.1)}`,backdropFilter:"blur(10px)",bgcolor:"rgba(255, 255, 255, 0.7)"},children:[c.icon,o.jsx(i,{variant:"h5",component:"h2",gutterBottom:!0,sx:{fontWeight:"bold",color:"#1a1a1a"},children:c.title}),o.jsx(i,{variant:"body1",color:"#555555",paragraph:!0,sx:{mb:3},children:c.description}),o.jsxs(s,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"center",gap:2,mt:2},children:[o.jsx(u,{variant:"contained",sx:{bgcolor:"#1a1a1a",color:"#fff","&:hover":{bgcolor:"#333"},boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)"},startIcon:o.jsx(p,{}),onClick:n,fullWidth:!1,children:c.primaryAction}),o.jsx(u,{variant:"outlined",sx:{color:"#1a1a1a",borderColor:a("#1a1a1a",.3),"&:hover":{borderColor:"#1a1a1a",bgcolor:a("#1a1a1a",.02)}},startIcon:o.jsx(f,{}),component:"a",href:"mailto:support@swapcred.com",fullWidth:!1,children:c.secondaryAction})]})]})})},B=({status:e})=>{switch(e){case"approved":return o.jsx(c,{icon:o.jsx(d,{}),label:"Approved",color:"success",variant:"outlined",size:"small",sx:{borderColor:"#888",color:"#1a1a1a"}});case"declined":return o.jsx(c,{icon:o.jsx(F,{}),label:"Declined",color:"error",variant:"outlined",size:"small",sx:{borderColor:"#888",color:"#1a1a1a"}});case"completed":return o.jsx(c,{icon:o.jsx(d,{}),label:"Completed",color:"success",variant:"outlined",size:"small",sx:{bgcolor:a("#888",.1),borderColor:"#888",color:"#1a1a1a"}});default:return o.jsx(c,{icon:o.jsx(E,{}),label:"Pending",color:"warning",variant:"outlined",size:"small",sx:{borderColor:"#888",color:"#1a1a1a"}})}},q=({status:r,transitStatus:t})=>{e();let n="",l=o.jsx(E,{}),c="#888";if(t)switch(t){case"shipped":n="Item has been shipped to us",l=o.jsx(L,{}),c="#555";break;case"received":n="Item received and under inspection",l=o.jsx(P,{}),c="#555";break;case"ready":n="Ready to ship back to you",l=o.jsx(L,{}),c="#555";break;default:n=`Transit status: ${t}`,l=o.jsx(L,{}),c="#555"}else switch(r){case"approved":n="Exchange approved! Points added to account",l=o.jsx(d,{}),c="#1a1a1a";break;case"declined":n="Exchange request declined",l=o.jsx(F,{}),c="#555";break;case"completed":n="Exchange process completed",l=o.jsx(d,{}),c="#1a1a1a";break;default:n="Exchange pending review",l=o.jsx(E,{}),c="#888"}return o.jsxs(s,{sx:{display:"flex",alignItems:"center",px:1.5,py:.75,borderRadius:1,bgcolor:a(c,.05),backdropFilter:"blur(10px)",border:"1px solid",borderColor:a(c,.1),boxShadow:`0 4px 6px ${a("#000",.05)}`,mb:1},children:[o.jsx(D,{sx:{width:24,height:24,bgcolor:a(c,.1),mr:1},children:T.cloneElement(l,{sx:{fontSize:16,color:c}})}),o.jsx(i,{variant:"body2",sx:{color:"#333",fontWeight:500,fontSize:"0.8rem"},children:n})]})};function H(){const{currentUser:n,userProfile:d,fetchUserProfile:f}=N(),[g,m]=b.useState(!0),[E,F]=b.useState(""),[D,T]=b.useState(null),[L,H]=b.useState([]),[V,Y]=b.useState([]),[X,G]=b.useState(""),[K,Q]=b.useState(0),[Z,J]=b.useState("INR"),[ee,ae]=b.useState(!1),oe=e(),re=j(oe.breakpoints.down("sm")),te=async()=>{var e;try{m(!0),F(""),T(null);const o={Authorization:`Bearer ${await n.getIdToken()}`},r=await O.get("/api/exchange",{headers:o});H(r.data),Y(r.data);try{const e=await O.get("/api/shopify/credit",{headers:o});e.data.error&&(e.data.error.includes("not found")?T({type:"shopify_user_not_found",message:e.data.error,email:n.email}):T({type:"connection_error",message:e.data.error})),Q(e.data.creditAmount||0),J(e.data.currency||"INR")}catch(a){a.response?404===a.response.status?T({type:"shopify_user_not_found",message:"User not found in Shopify",email:n.email}):T({type:"connection_error",message:(null==(e=a.response.data)?void 0:e.error)||"Error connecting to Shopify"}):a.request?T({type:"connection_error",message:"No response from server"}):T({type:"unknown",message:a.message})}}catch(o){F("Failed to load data. Please try again later.")}finally{m(!1),ae(!1)}},se=()=>{ae(!0),te()};return b.useEffect((()=>{te()}),[n]),b.useEffect((()=>{(async()=>{if(n)try{await n.getIdToken(!0);(await n.getIdTokenResult()).claims.admin&&!(null==d?void 0:d.isAdmin)&&await f()}catch(e){}})()}),[n,d,f]),D&&!g?o.jsx(M,{errorType:D.type,message:D.message,email:D.email,onRetry:se}):g&&!ee?o.jsx(x,{maxWidth:"lg",sx:{mt:4},children:o.jsxs(y,{container:!0,spacing:4,children:[o.jsx(y,{item:!0,xs:12,md:4,children:o.jsx(l,{variant:"rounded",height:160,animation:"wave",sx:{bgcolor:a("#888",.1)}})}),o.jsxs(y,{item:!0,xs:12,md:8,children:[o.jsx(l,{variant:"rounded",height:80,animation:"wave",sx:{mb:2,bgcolor:a("#888",.1)}}),o.jsx(l,{variant:"rounded",height:120,animation:"wave",sx:{bgcolor:a("#888",.1)}})]})]})}):o.jsxs(x,{maxWidth:"lg",sx:{py:4},children:[o.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4,flexDirection:{xs:"column",sm:"row"},gap:{xs:2,sm:0}},children:[o.jsx(i,{variant:"h4",component:"h1",sx:{fontWeight:"bold",backgroundImage:"linear-gradient(45deg, #1a1a1a, #888)",backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",textFillColor:"transparent"},children:"Your Dashboard"}),o.jsxs(s,{sx:{display:"flex",gap:2},children:[o.jsx(u,{variant:"contained",sx:{bgcolor:"#1a1a1a",color:"#fff","&:hover":{bgcolor:"#333"},boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)"},startIcon:o.jsx(v,{}),component:w,to:"/exchange/new",size:re?"small":"medium",children:"New Exchange"}),o.jsx(S,{onClick:se,sx:{bgcolor:a("#1a1a1a",.05),color:"#1a1a1a",border:"1px solid",borderColor:a("#1a1a1a",.1),backdropFilter:"blur(8px)",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.05)","&:hover":{bgcolor:a("#1a1a1a",.1)}},children:o.jsx(p,{})})]})]}),ee&&o.jsx(C,{sx:{mb:3,borderRadius:1,bgcolor:a("#888",.1),"& .MuiLinearProgress-bar":{bgcolor:"#1a1a1a"}}}),E&&o.jsx(k,{severity:"error",sx:{mb:4},children:E}),o.jsxs(y,{container:!0,spacing:4,children:[o.jsx(y,{item:!0,xs:12,md:4,children:o.jsx(s,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:o.jsx(U,{creditAmount:K,creditCurrency:Z,isLoading:g,username:(null==d?void 0:d.name)||(null==n?void 0:n.email)})})}),o.jsx(y,{item:!0,xs:12,md:8,children:o.jsxs(r,{elevation:0,sx:{height:"100%",display:"flex",flexDirection:"column",bgcolor:"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(10px)",border:"1px solid",borderColor:a("#888",.2),boxShadow:"0 10px 30px rgba(0, 0, 0, 0.08)",borderRadius:2},children:[o.jsx(A,{title:o.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs(i,{variant:"h6",component:"div",sx:{fontWeight:600,display:"flex",alignItems:"center",color:"#1a1a1a"},children:[o.jsx(I,{sx:{mr:1,color:"#1a1a1a"}}),"Recent Exchanges"]}),L.length>0&&o.jsx(c,{label:`${L.length} ${1===L.length?"Request":"Requests"}`,size:"small",variant:"outlined",sx:{color:"#1a1a1a",borderColor:a("#1a1a1a",.3)}})]}),sx:{pb:0}}),o.jsx(s,{sx:{px:2,pt:1,pb:2},children:o.jsx(z,{fullWidth:!0,size:"small",placeholder:"Search exchanges...",value:X,onChange:e=>{const a=e.target.value.toLowerCase();if(G(a),!a)return void Y(L);const o=L.filter((e=>{var o,r,t;return(null==(o=e.productName)?void 0:o.toLowerCase().includes(a))||(null==(r=e.brand)?void 0:r.toLowerCase().includes(a))||(null==(t=e.status)?void 0:t.toLowerCase().includes(a))}));Y(o)},variant:"outlined",InputProps:{startAdornment:o.jsx(R,{position:"start",children:o.jsx(W,{fontSize:"small",sx:{color:"#888"}})}),sx:{borderRadius:2,bgcolor:a("#000",.02),"& .MuiOutlinedInput-notchedOutline":{borderColor:a("#888",.2)},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:a("#888",.3)},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#1a1a1a"}}}})}),o.jsx(t,{sx:{flex:1,overflowY:"auto",px:2,pt:0},children:0===V.length?o.jsx(s,{sx:{py:4,textAlign:"center",bgcolor:a("#f8f8f8",.5),borderRadius:2},children:X?o.jsx(i,{variant:"body1",color:"#555",gutterBottom:!0,children:"No exchanges match your search."}):o.jsxs(o.Fragment,{children:[o.jsx(i,{variant:"body1",color:"#555",gutterBottom:!0,children:"You haven't submitted any exchange requests yet."}),o.jsx(u,{variant:"outlined",sx:{mt:2,color:"#1a1a1a",borderColor:"#1a1a1a","&:hover":{borderColor:"#000",bgcolor:a("#000",.02)}},startIcon:o.jsx(v,{}),component:w,to:"/exchange/new",children:"Create Your First Exchange"})]})}):o.jsx($,{spacing:2,children:V.map((e=>o.jsx(h,{elevation:0,sx:{p:2,borderRadius:2,border:"1px solid",borderColor:a("#888",.2),bgcolor:"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(8px)",transition:"all 0.2s ease-in-out","&:hover":{borderColor:a("#1a1a1a",.3),boxShadow:`0 8px 16px ${a("#000",.08)}`,transform:"translateY(-2px)"}},children:o.jsxs(y,{container:!0,spacing:2,children:[o.jsx(y,{item:!0,xs:3,sm:2,children:o.jsx(s,{sx:{width:"100%",aspectRatio:"1/1",borderRadius:1.5,overflow:"hidden",bgcolor:a("#f5f5f5",.8),display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid",borderColor:a("#888",.1),boxShadow:`inset 0 0 0 1px ${a("#fff",.4)}`},children:e.productImage?o.jsx("img",{src:e.productImage,alt:e.productName,style:{width:"100%",height:"100%",objectFit:"cover"}}):o.jsx(P,{sx:{opacity:.4,color:"#555"}})})}),o.jsxs(y,{item:!0,xs:9,sm:10,children:[o.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[o.jsxs(s,{children:[o.jsx(i,{variant:"subtitle1",sx:{fontWeight:600,mb:.5,color:"#1a1a1a"},children:e.productName}),o.jsxs(i,{variant:"body2",sx:{mb:1,color:"#555"},children:[new Date(e.createdAt).toLocaleDateString()," • ",e.brand]})]}),o.jsx(B,{status:e.status})]}),o.jsx(q,{status:e.status,transitStatus:e.transitStatus}),"approved"===e.status&&e.creditAmount>0&&o.jsxs(i,{variant:"body2",sx:{fontWeight:"bold",color:"#1a1a1a",mt:1},children:["Credit: ₹",e.creditAmount.toFixed(2)]}),o.jsx(s,{sx:{display:"flex",justifyContent:"flex-end",mt:1},children:o.jsx(u,{size:"small",component:w,to:`/exchange/${e.id}`,endIcon:o.jsx(_,{}),sx:{color:"#1a1a1a","&:hover":{bgcolor:a("#1a1a1a",.05)}},children:"View Details"})})]})]})},e.id)))})}),L.length>5&&V.length>0&&!X&&o.jsx(s,{sx:{p:2,textAlign:"center"},children:o.jsx(u,{size:"medium",component:w,to:"/exchange",variant:"outlined",sx:{color:"#1a1a1a",borderColor:a("#1a1a1a",.3),"&:hover":{borderColor:"#1a1a1a",bgcolor:a("#1a1a1a",.02)}},children:"View All Requests"})})]})})]})]})}export{H as default};
